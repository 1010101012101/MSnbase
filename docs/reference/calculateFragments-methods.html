<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title> Calculate ions produced by fragmentation.  — calculateFragments-methods • MSnbase</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">MSnbase</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lgatto/MSnbase">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1> Calculate ions produced by fragmentation. </h1>
    </div>

    
    <p>These method calculates a-, b-, c-, x-, y- and z-ions produced by
  fragmentation.</p>
    

    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>sequence</dt>
      <dd> <code>character</code>, peptide sequence. </dd>
      <dt>object</dt>
      <dd> Object of class <code>&quot;<a href='Spectrum2-class.html'>Spectrum2</a>&quot;</code> or
    <code>&quot;missing&quot;</code> . </dd>
      <dt>tolerance</dt>
      <dd> <code>numeric</code> tolerance between the theoretical and
    measured MZ values (only available if <code>object</code> is not <code>missing</code>).</dd>
      <dt>method</dt>
      <dd> <code>method</code> used for for duplicated matches. Choose
    <code>&quot;highest&quot;</code> or <code>&quot;closest&quot;</code> to select the peak with the highest
    intensity respectively the closest MZ in the tolerance range. If
    <code>&quot;all&quot;</code> is given all possible matches in the tolerance range are
    reported (only available if <code>object</code> is not <code>missing</code>).</dd>
      <dt>type</dt>
      <dd> <code>character</code> vector of target ions; possible values:
    <code>c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;x&quot;, &quot;y&quot;, &quot;z&quot;)</code>; default: <code>type=c(&quot;b&quot;, &quot;y&quot;)</code>. </dd>
      <dt>z</dt>
      <dd> <code>numeric</code> desired charge state; default <code>z=1</code>. </dd>
      <dt>modifications</dt>
      <dd> named <code>numeric</code> vector of used modifications. The
    name must correspond to the one-letter-code of the modified amino acid and
    the <code>numeric</code> value must represent the mass that should be added to the
    original amino accid mass, default:
    Carbamidomethyl <code>modifications=c(C=57.02146)</code>. Use <code>Nterm</code> or
    <code>Cterm</code> as names for modifications that should be added to the amino
    respectively carboxyl-terminus.</dd>
      <dt>neutralLoss</dt>
      <dd> <code>list</code>, it has to have two named elments,
    namely <code>water</code> and <code>ammonia</code> that contain a
    <code>character</code> vector which type of neutral loss should be calculated.
    Currently neutral loss on the C terminal <code>&quot;Cterm&quot;</code>, at the amino acids
    <code>c(&quot;D&quot;, &quot;E&quot;, &quot;S&quot;, &quot;T&quot;)</code> for <code>&quot;water&quot;</code> (shown with an <code>_</code>)
    and <code>c(&quot;K&quot;, &quot;N&quot;, &quot;Q&quot;, &quot;R&quot;)</code> for <code>&quot;ammonia&quot;</code> (shown with an
    <code>*</code>) are supported.
    There is a helper function <code>defaultNeutralLoss</code> that returns the
    correct list. It has two arguments <code>disableWaterLoss</code> and
    <code>disableAmmoniaLoss</code> to remove single neutral loss options. See the
    example section for use cases.</dd>
      <dt>verbose</dt>
      <dd> <code>logical</code> if <code>TRUE</code> (default) the used
    modifications are printed. </dd>
    </dl>
    
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    <p><dl class='dl-horizontal'>
    <dt><code>signature(sequence = &quot;character&quot;, object = &quot;missing&quot;, &#8230;)</code></dt><dd>
      Calculates the theoretical fragments for a peptide <code>sequence</code>.
      Returns a <code>data.frame</code> with the columns <code>c(&quot;mz&quot;, &quot;ion&quot;, &quot;type&quot;,
        &quot;pos&quot;, &quot;z&quot;, &quot;seq&quot;)</code>.
    </dd>
    <dt><code>signature(sequence = &quot;character&quot;, object = &quot;Spectrum2&quot;, &#8230;)</code></dt><dd>
      Calculates and matches the theoretical fragments for a peptide
      <code>sequence</code> and a <code>&quot;<a href='Spectrum2-class.html'>Spectrum2</a>&quot;</code> <code>object</code>.
      The <code>&#8230;</code> arguments are passed to the internal functions.
      Currently <code>tolerance</code>, <code>method</code> and <code>relative</code> are
      supported.
      You could change the <code>tolerance</code> (default <code>25e-6</code>) and
      decide whether this tolerance should be applied relative
      (default <code>relative = TRUE</code>) or absolute (<code>relative = FALSE</code>)
      to match the theoretical fragment MZ with the MZ of the spectrum.
      In cases of multiple matches use <code>method</code> to select the peak with
      the highest intensity (<code>method = &quot;highest&quot;</code>, default) respectively
      closest MZ (<code>method = &quot;closes&quot;</code>). If <code>method = &quot;all&quot;</code> is set
      all possible matches in the current tolerance range are reported.
      Returns the same <code>data.frame</code> as above but the <code>mz</code> column
      represents the matched MZ values of the spectrum. Additionally there
      is a column <code>error</code> that contains the difference between the observed
      MZ (from the spectrum) to the theoretical fragment MZ.
    </dd>
  </dl></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## find path to a mzXML file</span>
<span class='no'>file</span> <span class='kw'>&lt;-</span> <span class='fu'>dir</span>(<span class='fu'>system.file</span>(<span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"MSnbase"</span>, <span class='kw'>dir</span> <span class='kw'>=</span> <span class='st'>"extdata"</span>),
            <span class='kw'>full.name</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>pattern</span> <span class='kw'>=</span> <span class='st'>"mzXML$"</span>)

<span class='co'>## create basic MSnExp</span>
<span class='no'>msexp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='readMSData.html'>readMSData</a></span>(<span class='no'>file</span>, <span class='kw'>centroided</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; Reading 5 MS2 spectra from file dummyiTRAQ.mzXML
#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |==============                                                        |  20%  |                                                                              |============================                                          |  40%  |                                                                              |==========================================                            |  60%  |                                                                              |========================================================              |  80%  |                                                                              |======================================================================| 100%
#&gt; Creating &#39;MSnExp&#39; object</div><div class='input'>
<span class='co'>## centroid them</span>
<span class='no'>msexp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='pickPeaks-methods.html'>pickPeaks</a></span>(<span class='no'>msexp</span>)</div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |==============                                                        |  20%  |                                                                              |============================                                          |  40%  |                                                                              |==========================================                            |  60%  |                                                                              |========================================================              |  80%  |                                                                              |======================================================================| 100%</div><div class='input'>
<span class='co'>## calculate fragments for ACE with default modification</span>
<span class='fu'>calculateFragments</span>(<span class='st'>"ACE"</span>, <span class='kw'>modifications</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='kw'>C</span><span class='kw'>=</span><span class='fl'>57.02146</span>))</div><div class='output co'>#&gt; <span class='message'>Modifications used: C=57.02146</span></div><div class='output co'>#&gt;          mz ion type pos z seq
#&gt; 1  72.04439  b1    b   1 1   A
#&gt; 2 232.07504  b2    b   2 1  AC
#&gt; 3 361.11763  b3    b   3 1 ACE
#&gt; 4 148.06043  y1    y   1 1   E
#&gt; 5 308.09108  y2    y   2 1  CE
#&gt; 6 379.12819  y3    y   3 1 ACE
#&gt; 7 115.06278 y1_   y_   1 1   E
#&gt; 8 275.09343 y2_   y_   2 1  CE
#&gt; 9 346.13054 y3_   y_   3 1 ACE</div><div class='input'>
<span class='co'>## calculate fragments for ACE with an addition N-terminal modification</span>
<span class='fu'>calculateFragments</span>(<span class='st'>"ACE"</span>, <span class='kw'>modifications</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='kw'>C</span><span class='kw'>=</span><span class='fl'>57.02146</span>, <span class='kw'>Nterm</span><span class='kw'>=</span><span class='fl'>229.1629</span>))</div><div class='output co'>#&gt; <span class='message'>Modifications used: C=57.02146, Nterm=229.1629</span></div><div class='output co'>#&gt;         mz ion type pos z seq
#&gt; 1 301.2073  b1    b   1 1   A
#&gt; 2 461.2379  b2    b   2 1  AC
#&gt; 3 590.2805  b3    b   3 1 ACE
#&gt; 4 148.0604  y1    y   1 1   E
#&gt; 5 308.0911  y2    y   2 1  CE
#&gt; 6 379.1282  y3    y   3 1 ACE
#&gt; 7 115.0628 y1_   y_   1 1   E
#&gt; 8 275.0934 y2_   y_   2 1  CE
#&gt; 9 346.1305 y3_   y_   3 1 ACE</div><div class='input'>
<span class='co'>## calculate fragments for ACE without any modifications</span>
<span class='fu'>calculateFragments</span>(<span class='st'>"ACE"</span>, <span class='kw'>modifications</span><span class='kw'>=</span><span class='kw'>NULL</span>)</div><div class='output co'>#&gt; <span class='message'>Modifications used: None</span></div><div class='output co'>#&gt;          mz ion type pos z seq
#&gt; 1  72.04439  b1    b   1 1   A
#&gt; 2 175.05358  b2    b   2 1  AC
#&gt; 3 304.09617  b3    b   3 1 ACE
#&gt; 4 148.06043  y1    y   1 1   E
#&gt; 5 251.06962  y2    y   2 1  CE
#&gt; 6 322.10673  y3    y   3 1 ACE
#&gt; 7 115.06278 y1_   y_   1 1   E
#&gt; 8 218.07197 y2_   y_   2 1  CE
#&gt; 9 289.10908 y3_   y_   3 1 ACE</div><div class='input'>
<span class='fu'>calculateFragments</span>(<span class='st'>"VESITARHGEVLQLRPK"</span>,
                   <span class='kw'>type</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"a"</span>, <span class='st'>"b"</span>, <span class='st'>"c"</span>, <span class='st'>"x"</span>, <span class='st'>"y"</span>, <span class='st'>"z"</span>),
                   <span class='kw'>z</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>2</span>)</div><div class='output co'>#&gt; <span class='message'>Modifications used: C=57.02146</span></div><div class='output co'>#&gt;             mz  ion type pos z               seq
#&gt; 1     72.08077   a1    a   1 1                 V
#&gt; 2     36.54402   a1    a   1 2                 V
#&gt; 3    201.12336   a2    a   2 1                VE
#&gt; 4    101.06532   a2    a   2 2                VE
#&gt; 5    288.15539   a3    a   3 1               VES
#&gt; 6    144.58133   a3    a   3 2               VES
#&gt; 7    401.23945   a4    a   4 1              VESI
#&gt; 8    201.12336   a4    a   4 2              VESI
#&gt; 9    502.28713   a5    a   5 1             VESIT
#&gt; 10   251.64720   a5    a   5 2             VESIT
#&gt; 11   573.32424   a6    a   6 1            VESITA
#&gt; 12   287.16576   a6    a   6 2            VESITA
#&gt; 13   729.42535   a7    a   7 1           VESITAR
#&gt; 14   365.21631   a7    a   7 2           VESITAR
#&gt; 15   866.48426   a8    a   8 1          VESITARH
#&gt; 16   433.74577   a8    a   8 2          VESITARH
#&gt;  [ reached getOption(&quot;max.print&quot;) -- omitted 518 rows ]</div><div class='input'>
<span class='fu'>calculateFragments</span>(<span class='st'>"VESITARHGEVLQLRPK"</span>, <span class='no'>msexp</span><span class='kw'>[[</span><span class='fl'>1</span>]])</div><div class='output co'>#&gt; <span class='message'>Modifications used: C=57.02146</span></div><div class='output co'>#&gt;          mz intensity  ion type pos z               seq       error
#&gt; 1  114.1109  706555.7  y1_   y_   1 1                 K  0.00425275
#&gt; 2  429.2563 1972344.0   b4    b   4 1              VESI -0.02189010
#&gt; 3  513.3047 2574137.0   y4    y   4 1              LRPK  0.04598246
#&gt; 4  754.4504  537234.8   y6    y   6 1            LQLRPK  0.04293155
#&gt; 5  982.5354  500159.1   y8    y   8 1          EVLQLRPK  0.06897061
#&gt; 6 1080.5867  209363.7  b10    b  10 1        VESITARHGE -0.04344392
#&gt; 7 1688.0375  136748.8 y15*   y*  15 1   SITARHGEVLQLRPK -0.07729359
#&gt; 8 1882.0074  149649.1 b17_   b_  17 1 VESITARHGEVLQLRPK  0.08206471</div><div class='input'>
<span class='co'>## neutral loss</span>
<span class='fu'>defaultNeutralLoss</span>()</div><div class='output co'>#&gt; $water
#&gt; [1] &quot;Cterm&quot; &quot;D&quot;     &quot;E&quot;     &quot;S&quot;     &quot;T&quot;    
#&gt; 
#&gt; $ammonia
#&gt; [1] &quot;K&quot; &quot;N&quot; &quot;Q&quot; &quot;R&quot;
#&gt; </div><div class='input'>
<span class='co'>## disable water loss on the C terminal</span>
<span class='fu'>defaultNeutralLoss</span>(<span class='kw'>disableWaterLoss</span><span class='kw'>=</span><span class='st'>"Cterm"</span>)</div><div class='output co'>#&gt; $water
#&gt; [1] &quot;D&quot; &quot;E&quot; &quot;S&quot; &quot;T&quot;
#&gt; 
#&gt; $ammonia
#&gt; [1] &quot;K&quot; &quot;N&quot; &quot;Q&quot; &quot;R&quot;
#&gt; </div><div class='input'>
<span class='co'>## real example</span>
<span class='fu'>calculateFragments</span>(<span class='st'>"PQR"</span>)</div><div class='output co'>#&gt; <span class='message'>Modifications used: C=57.02146</span></div><div class='output co'>#&gt;           mz ion type pos z seq
#&gt; 1   98.06004  b1    b   1 1   P
#&gt; 2  226.11862  b2    b   2 1  PQ
#&gt; 3  382.21973  b3    b   3 1 PQR
#&gt; 4  175.11895  y1    y   1 1   R
#&gt; 5  303.17753  y2    y   2 1  QR
#&gt; 6  400.23029  y3    y   3 1 PQR
#&gt; 7  142.12130 y1_   y_   1 1   R
#&gt; 8  270.17988 y2_   y_   2 1  QR
#&gt; 9  367.23264 y3_   y_   3 1 PQR
#&gt; 10 365.19318 b3*   b*   3 1 PQR
#&gt; 11 286.15098 y2*   y*   2 1  QR
#&gt; 12 383.20374 y3*   y*   3 1 PQR</div><div class='input'><span class='fu'>calculateFragments</span>(<span class='st'>"PQR"</span>,
                   <span class='kw'>neutralLoss</span><span class='kw'>=</span><span class='fu'>defaultNeutralLoss</span>(<span class='kw'>disableWaterLoss</span><span class='kw'>=</span><span class='st'>"Cterm"</span>))</div><div class='output co'>#&gt; <span class='message'>Modifications used: C=57.02146</span></div><div class='output co'>#&gt;          mz ion type pos z seq
#&gt; 1  98.06004  b1    b   1 1   P
#&gt; 2 226.11862  b2    b   2 1  PQ
#&gt; 3 382.21973  b3    b   3 1 PQR
#&gt; 4 175.11895  y1    y   1 1   R
#&gt; 5 303.17753  y2    y   2 1  QR
#&gt; 6 400.23029  y3    y   3 1 PQR
#&gt; 7 365.19318 b3*   b*   3 1 PQR
#&gt; 8 286.15098 y2*   y*   2 1  QR
#&gt; 9 383.20374 y3*   y*   3 1 PQR</div><div class='input'><span class='fu'>calculateFragments</span>(<span class='st'>"PQR"</span>,
                   <span class='kw'>neutralLoss</span><span class='kw'>=</span><span class='fu'>defaultNeutralLoss</span>(<span class='kw'>disableAmmoniaLoss</span><span class='kw'>=</span><span class='st'>"Q"</span>))</div><div class='output co'>#&gt; <span class='message'>Modifications used: C=57.02146</span></div><div class='output co'>#&gt;          mz ion type pos z seq
#&gt; 1  98.06004  b1    b   1 1   P
#&gt; 2 226.11862  b2    b   2 1  PQ
#&gt; 3 382.21973  b3    b   3 1 PQR
#&gt; 4 175.11895  y1    y   1 1   R
#&gt; 5 303.17753  y2    y   2 1  QR
#&gt; 6 400.23029  y3    y   3 1 PQR
#&gt; 7 142.12130 y1_   y_   1 1   R
#&gt; 8 270.17988 y2_   y_   2 1  QR
#&gt; 9 367.23264 y3_   y_   3 1 PQR</div><div class='input'>
<span class='co'>## disable neutral loss completely</span>
<span class='fu'>calculateFragments</span>(<span class='st'>"PQR"</span>, <span class='kw'>neutralLoss</span><span class='kw'>=</span><span class='kw'>NULL</span>)</div><div class='output co'>#&gt; <span class='message'>Modifications used: C=57.02146</span></div><div class='output co'>#&gt;          mz ion type pos z seq
#&gt; 1  98.06004  b1    b   1 1   P
#&gt; 2 226.11862  b2    b   2 1  PQ
#&gt; 3 382.21973  b3    b   3 1 PQR
#&gt; 4 175.11895  y1    y   1 1   R
#&gt; 5 303.17753  y2    y   2 1  QR
#&gt; 6 400.23029  y3    y   3 1 PQR</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#methods">Methods</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
  Sebastian Gibb &lt;mail@sebastiangibb.de&gt;

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
