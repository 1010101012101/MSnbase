<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title> Quantifies &#39;MSnExp&#39; and &#39;Spectrum&#39; objects  — quantify-methods • MSnbase</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">MSnbase</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lgatto/MSnbase">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1> Quantifies &#39;MSnExp&#39; and &#39;Spectrum&#39; objects </h1>
    </div>

    
    <p>This method quantifies individual <code>&quot;<a href='Spectrum-class.html'>Spectrum</a>&quot;</code>
  objects or full <code>&quot;<a href='MSnExp-class.html'>MSnExp</a>&quot;</code> experiments. Current,
  MS2-level isobar tagging using iTRAQ and TMT (or any arbitrary peaks
  of interest, see <code>&quot;<a href='ReporterIons-class.html'>ReporterIons</a>&quot;</code>) and MS2-level
  label-free quantitation (spectral counting, spectral index or spectral
  abundance factor) are available.</p>

    <p>Isobaric tag peaks of single spectra or complete experiments can be
  quantified using appropriate <code>methods</code>. Label-free quantitation
  is available only for <code>MSnExp</code> experiments.</p>

    <p>Since version 1.13.5, parallel quantitation is supported by the
  <code>BiocParallel</code> package and controlled by the <code>BPPARAM</code>
  argument.</p>
    

    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>object</dt>
      <dd>
    An instance of class <code>&quot;<a href='Spectrum-class.html'>Spectrum</a>&quot;</code> (isobaric
    tagging only) or <code>&quot;<a href='MSnExp-class.html'>MSnExp</a>&quot;</code>.
  </dd>
      <dt>method</dt>
      <dd>
    Peak quantitation method. For isobaric tags, one of, possibly
    abreviated <code>&quot;trapezoidation&quot;</code>, <code>&quot;max&quot;</code>, or
    <code>&quot;sum&quot;</code>. These methods return respectively the area under the
    peak(s), the maximum of the peak(s) or the sum of all intensities of
    the peak(s).

    For label-free quantitation, one of <code>&quot;SI&quot;</code> (spectral index),
    <code>&quot;SIgi&quot;</code> (global intensity spectral index), <code>&quot;SIn&quot;</code>
    (normalised spectral index), <code>&quot;SAF&quot;</code> (spectral abundance
    factor) or <code>&quot;NSAF&quot;</code> (normalised spectral abundance factor).

    Finally, the simple <code>&quot;count&quot;</code> method counts the occurrence of
    the respective spectra (at this stage all 1s) that can then be used
    as input to <code><a href='combineFeatures.html'>combineFeatures</a></code> to implement spectra
    counting. 

  </dd>
      <dt>reporters</dt>
      <dd>
    An instance of class <code>&quot;<a href='ReporterIons-class.html'>ReporterIons</a>&quot;</code> that defines
    the peak(s) to be quantified. For isobaric tagging only.
  </dd>
      <dt>strict</dt>
      <dd>
    For isobaric tagging only.  If strict is <code>FALSE</code> (default), the
    quantitation is performed using data points along the entire width
    of a peak. If strict is set to <code>TRUE</code>, once the apex(es) is/are
    identified, only data points within apex +/- width of reporter (see
    <code>&quot;<a href='ReporterIons-class.html'>ReporterIons</a>&quot;</code>) are used for quantitation.

  </dd>
      <dt>BPPARAM</dt>
      <dd>    
    Support for parallel processing using the <code>BiocParallel</code>
    infrastructure. When missing (default), the default registered
    <code>BiocParallelParam</code> parameters are applied using
    <code>bpparam()</code>. Alternatively, one can pass a valid
    <code>BiocParallelParam</code> parameter instance: <code>SnowParam</code>,
    <code>MulticoreParam</code>, <code>DoparParam</code>, &#8230; see the
    <code>BiocParallel</code> package for details.
  </dd>
      <dt>parallel</dt>
      <dd>
    Deprecated. Please see <code>BPPARAM</code>.   
  </dd>
      <dt>qual</dt>
      <dd>
    Should the <code>qual</code> slot be populated. Default is <code>TRUE</code>.
  </dd>
      <dt>verbose</dt>
      <dd>
    Verbose of the output (only for <code>MSnExp</code> objects).
  </dd>
      <dt>...</dt>
      <dd>
    Further arguments passed to the quantitation functions.
  </dd>
    </dl>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p></p>
    <p><code>&quot;<a href='ReporterIons-class.html'>ReporterIons</a>&quot;</code> define specific MZ at which peaks
  are expected and a window around that MZ value.  A peak of interest is
  searched for in that window.  Since version 1.1.2, warnings are not
  thrown anymore in case no data is found in that region or if the peak
  extends outside the window.  This can be checked manually after
  quantitation, by inspecting the quantitation data (using the
  <code>exprs</code> accessor) for <code>NA</code> values or by comaring the
  <code>lowerMz</code> and <code>upperMz</code> columns in the
  <code>&quot;<a href='MSnSet-class.html'>MSnSet</a>&quot;</code> <code>qual</code> slot against the respective
  expected <code>mz(reporters)</code> +/- <code>width(reporters)</code>.</p>
    <p>Once the range of the curve is found, quantification is performed.  If
  no data points are found in the expected region, <code>NA</code> is returned
  for the reporter peak MZ.</p>
    <p>Note that for label-free, spectra that have not been identified (the
  corresponding fields in the feature data are populated with <code>NA</code>
  values) or that have been uniquely assigned to a protein (the
  <code>nprot</code> feature data is greater that 1) are removed prior to
  quantitation. The latter does not apply for <code>method = &quot;count&quot;</code>
  but can be applied manually with
  <code><a href='MSnSet-class.html'>removeMultipleAssignment</a></code>.</p>
    
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    <p><dl class='dl-horizontal'>
    <dt>
      <code>signature(object = &quot;MSnExp&quot;, method = &quot;character&quot;, reporters
	= &quot;ReporterIons&quot;, verbose = &quot;logical&quot;, ...)</code></dt><dd></p>
    <p>For isobaric tagging, quantifies peaks defined in <code>reporters</code>
      using <code>method</code> in all spectra of the <code>MSnExp</code> object. If
      verbose is set to <code>TRUE</code>, a progress bar will be displayed.</p>
    <p>For label-free quantitation, the respective quantitation methods
      and normalisations are applied to the spectra. These methods
      require two additional arguments (<code>...</code>), namely the protein
      accession of identifiers (<code>fcol</code>, with detault value
      <code>&quot;accession&quot;</code>) and the protein lengths (<code>plength</code>, with
      default value <code>&quot;length&quot;</code>). These values are available of the
      identification data had been collated using
      <code><a href='addIdentificationData-methods.html'>addIdentificationData</a></code>.</p>
    <p>An object of class <code>&quot;<a href='MSnSet-class.html'>MSnSet</a>&quot;</code> is returned
      containing the quantified feature expression and all meta data
      inherited from the <code>MSnExp</code> <code>object</code> argument.</p>
    <p></dd></p>
    <p><dt><code>signature(object = &quot;Spectrum&quot;, method = &quot;character&quot;,
	reporters = &quot;ReporterIons&quot;)</code></dt><dd></p>
    <p>Quantifies peaks defined in <code>reporters</code> using <code>method</code>
      in the <code>Spectrum</code> object (isobaric tagging only).</p>
    <p>A list of length 2 will be returned. The first element, named
      <code>peakQuant</code>, is a &#39;numeric&#39; of length equal to
      <code>length(reporters)</code> with quantitation of the reporter peaks
      using <code>method</code>.</p>
    <p>The second element, names <code>curveStats</code>, is a &#39;data.frame&#39; of
      dimension <code>length(reporters)</code> times 7 giving, for each
      reporter curve parameters: maximum intensity (<code>&#39;maxInt&#39;</code>),
      number of maxima (<code>&#39;nMaxInt&#39;</code>), number of data points defined
      the curve (<code>&#39;baseLength&#39;</code>), lower and upper MZ values for the
      curve (<code>&#39;lowerMz&#39;</code> and <code>&#39;upperMz&#39;</code>), reporter
      (<code>&#39;reporter&#39;</code>) and precursor MZ value (<code>&#39;precursor&#39;</code>)
      when available.</p>
    <p></dd>
  </dl></p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p></p>
    <p>For details about the spectral index (SI), see Griffin NM, Yu J, Long
  F, Oh P, Shore S, Li Y, Koziol JA, Schnitzer JE.  <em>Label-free,
  normalized quantification of complex mass spectrometry data for
  proteomic analysis</em>. Nat Biotechnol. 2010 Jan;28(1):83-9. doi:
  10.1038/nbt.1592. PMID: 20010810; PubMed Central PMCID: PMC2805705.</p>
    <p>For details about the spectra abundance factor, see Paoletti AC,
  Parmely TJ, Tomomori-Sato C, Sato S, Zhu D, Conaway RC, Conaway JW,
  Florens L, Washburn MP. <em>Quantitative proteomic analysis of
  distinct mammalian Mediator complexes using normalized spectral
  abundance factors</em>. PNAS. 2006 Dec 12;103(50):18928-33. PMID:
  17138671; PubMed Central PMCID: PMC1672612.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Quantifying a full experiment using iTRAQ4-plex tagging</span>
<span class='fu'>data</span>(<span class='no'>itraqdata</span>)
<span class='no'>msnset</span> <span class='kw'>&lt;-</span> <span class='fu'>quantify</span>(<span class='no'>itraqdata</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"trap"</span>, <span class='kw'>reporters</span> <span class='kw'>=</span> <span class='no'>iTRAQ4</span>)</div><div class='output co'>#&gt; <span class='message'>Using default parallel backend: MulticoreParam</span></div><div class='output co'>#&gt; <span class='message'>Original MSnExp and new MSnSet have different number of samples in phenoData. Dropping original.</span></div><div class='output co'>#&gt; <span class='message'>Creating &#39;MSnSet&#39; object</span></div><div class='input'><span class='no'>msnset</span></div><div class='output co'>#&gt; MSnSet (storageMode: lockedEnvironment)
#&gt; assayData: 55 features, 4 samples 
#&gt;   element names: exprs 
#&gt; protocolData: none
#&gt; phenoData
#&gt;   sampleNames: iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117
#&gt;   varLabels: mz reporters
#&gt;   varMetadata: labelDescription
#&gt; featureData
#&gt;   featureNames: X1 X10 ... X9 (55 total)
#&gt;   fvarLabels: spectrum ProteinAccession ... collision.energy (15 total)
#&gt;   fvarMetadata: labelDescription
#&gt; experimentData: use &#39;experimentData(object)&#39;
#&gt; Annotation: No annotation 
#&gt; - - - Processing information - - -
#&gt; Data loaded: Wed May 11 18:54:39 2011 
#&gt; Updated from version 0.3.0 to 0.3.1 [Fri Jul  8 20:23:25 2016] 
#&gt; iTRAQ4 quantification by trapezoidation: Sun Dec 18 17:02:59 2016 
#&gt;  MSnbase version: 1.1.22 </div><div class='input'>
<span class='co'>## specifying a custom parallel framework</span>
<span class='co'>## bp &lt;- MulticoreParam(2L) # on Linux/OSX</span>
<span class='co'>## bp &lt;- SnowParam(2L) # on Windows</span>
<span class='co'>## quantify(itraqdata[1:10], method = "trap", iTRAQ4, BPPARAM = bp)</span>

<span class='co'>## Checking for non-quantified peaks</span>
<span class='fu'>sum</span>(<span class='fu'>is.na</span>(<span class='fu'>exprs</span>(<span class='no'>msnset</span>)))</div><div class='output co'>#&gt; [1] 1</div><div class='input'>
<span class='co'>## Quantifying a single spectrum</span>
<span class='no'>qty</span> <span class='kw'>&lt;-</span> <span class='fu'>quantify</span>(<span class='no'>itraqdata</span><span class='kw'>[[</span><span class='fl'>1</span>]], <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"trap"</span>, <span class='no'>iTRAQ4</span>[<span class='fl'>1</span>])
<span class='no'>qty</span>$<span class='no'>peakQuant</span></div><div class='output co'>#&gt; iTRAQ4.114 
#&gt;   1347.616 </div><div class='input'><span class='no'>qty</span>$<span class='no'>curveStats</span></div><div class='output co'>#&gt;        maxInt nMaxInt baseLength  lowerMz  upperMz reporter precursor
#&gt; [1,] 197455.8       1         11 114.1012 114.1196 114.1112  520.7833</div><div class='input'>

<span class='co'>## Label-free quantitation</span>
<span class='co'>## Raw (mzXML) and identification (mzid) files</span>
<span class='no'>quantFile</span> <span class='kw'>&lt;-</span> <span class='fu'>dir</span>(<span class='fu'>system.file</span>(<span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"MSnbase"</span>, <span class='kw'>dir</span> <span class='kw'>=</span> <span class='st'>"extdata"</span>),
                 <span class='kw'>full.name</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>pattern</span> <span class='kw'>=</span> <span class='st'>"mzXML$"</span>)
<span class='no'>identFile</span> <span class='kw'>&lt;-</span> <span class='fu'>dir</span>(<span class='fu'>system.file</span>(<span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"MSnbase"</span>, <span class='kw'>dir</span> <span class='kw'>=</span> <span class='st'>"extdata"</span>),
                 <span class='kw'>full.name</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>pattern</span> <span class='kw'>=</span> <span class='st'>"dummyiTRAQ.mzid"</span>)

<span class='no'>msexp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='readMSData.html'>readMSData</a></span>(<span class='no'>quantFile</span>)</div><div class='output co'>#&gt; Reading 5 MS2 spectra from file dummyiTRAQ.mzXML
#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |==============                                                        |  20%  |                                                                              |============================                                          |  40%  |                                                                              |==========================================                            |  60%  |                                                                              |========================================================              |  80%  |                                                                              |======================================================================| 100%
#&gt; Creating &#39;MSnExp&#39; object</div><div class='input'><span class='no'>msexp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='addIdentificationData-methods.html'>addIdentificationData</a></span>(<span class='no'>msexp</span>, <span class='no'>identFile</span>)</div><div class='output co'>#&gt; reading dummyiTRAQ.mzid... DONE!</div><div class='input'><span class='fu'>fData</span>(<span class='no'>msexp</span>)$<span class='no'>accession</span></div><div class='output co'>#&gt; [1] &quot;ECA0984;ECA3829&quot; &quot;ECA1028&quot;         NA                NA               
#&gt; [5] &quot;ECA0510&quot;        </div><div class='input'>
<span class='no'>si</span> <span class='kw'>&lt;-</span> <span class='fu'>quantify</span>(<span class='no'>msexp</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"SIn"</span>)</div><div class='output co'>#&gt; <span class='message'>Combined 2 features into 2 using sum</span></div><div class='input'><span class='fu'><a href='pSet-class.html'>processingData</a></span>(<span class='no'>si</span>)</div><div class='output co'>#&gt; - - - Processing information - - -
#&gt; Quantitation by total ion current [Sun Dec 18 17:03:00 2016] 
#&gt; Combined 2 features into 2 using sum: Sun Dec 18 17:03:00 2016 
#&gt; Quantification by SIn [Sun Dec 18 17:03:00 2016] 
#&gt;  MSnbase version: 2.1.6 </div><div class='input'><span class='fu'>exprs</span>(<span class='no'>si</span>)</div><div class='output co'>#&gt;         dummyiTRAQ.mzXML
#&gt; ECA0510      0.003588641
#&gt; ECA1028      0.001470129</div><div class='input'>
<span class='no'>saf</span> <span class='kw'>&lt;-</span> <span class='fu'>quantify</span>(<span class='no'>msexp</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"NSAF"</span>)</div><div class='output co'>#&gt; <span class='message'>Combined 2 features into 2 using user-defined function</span></div><div class='input'><span class='fu'><a href='pSet-class.html'>processingData</a></span>(<span class='no'>saf</span>)</div><div class='output co'>#&gt; - - - Processing information - - -
#&gt; Quantitation by count [Sun Dec 18 17:03:00 2016] 
#&gt; Combined 2 features into 2 using user-defined function: Sun Dec 18 17:03:00 2016 
#&gt; Quantification by NSAF [Sun Dec 18 17:03:00 2016] 
#&gt;  MSnbase version: 2.1.6 </div><div class='input'><span class='fu'>exprs</span>(<span class='no'>saf</span>)</div><div class='output co'>#&gt;         dummyiTRAQ.mzXML
#&gt; ECA0510        0.6235828
#&gt; ECA1028        0.3764172</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#methods">Methods</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
  Laurent Gatto &lt;lg390@cam.ac.uk&gt; and
  Sebastian Gibb &lt;mail@sebastiangibb.de&gt;

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Laurent Gatto, Johannes Rainer, Gibb Sebastian.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
